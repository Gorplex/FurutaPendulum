<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>PolyDAQ: task_sd_card.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PolyDAQ
   &#160;<span id="projectnumber">2.1</span>
   </div>
   <div id="projectbrief">Cal Poly ME Data Acquisition and Logging System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">task_sd_card.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Headers for a task which saves data to an SD card.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;taskbase.h&quot;</code><br/>
<code>#include &quot;sdio_card.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="logger__config_8h_source.html">logger_config.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="shares_8h_source.html">shares.h</a>&quot;</code><br/>
</div>
<p><a href="task__sd__card_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__sd__card.html">task_sd_card</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task which saves data to an SD card.  <a href="classtask__sd__card.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a80b1adfd8bda130e0cfdbbb3f943f4e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__sd__card_8h.html#a80b1adfd8bda130e0cfdbbb3f943f4e7">SD_TSK_DBG</a>(x)&#160;&#160;&#160;if (p_serial) *p_serial &lt;&lt; x</td></tr>
<tr class="memdesc:a80b1adfd8bda130e0cfdbbb3f943f4e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch to turn SD card task serial debugging messages on or off.  <a href="#a80b1adfd8bda130e0cfdbbb3f943f4e7">More...</a><br/></td></tr>
<tr class="separator:a80b1adfd8bda130e0cfdbbb3f943f4e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a583233f3de4cfe2f47c306fcc1621158"><td class="memItemLeft" align="right" valign="top">const uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__sd__card_8h.html#a583233f3de4cfe2f47c306fcc1621158">SD_TICKS_PER_SYNC</a> = 1000</td></tr>
<tr class="memdesc:a583233f3de4cfe2f47c306fcc1621158"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time in milliseconds between forced buffer writes to the SD card.  <a href="#a583233f3de4cfe2f47c306fcc1621158">More...</a><br/></td></tr>
<tr class="separator:a583233f3de4cfe2f47c306fcc1621158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a2d7dc24248a592b423dbc7efde902"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__sd__card_8h.html#ab0a2d7dc24248a592b423dbc7efde902">DATA_F_NAME</a> [] = &quot;data_&quot;</td></tr>
<tr class="memdesc:ab0a2d7dc24248a592b423dbc7efde902"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base name of the data file for the logger; a number is added after this name.  <a href="#ab0a2d7dc24248a592b423dbc7efde902">More...</a><br/></td></tr>
<tr class="separator:ab0a2d7dc24248a592b423dbc7efde902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d526e1e8a7ea73e0e0859b9e383dc25"><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__sd__card_8h.html#a5d526e1e8a7ea73e0e0859b9e383dc25">DATA_F_EXT</a> [] = &quot;csv&quot;</td></tr>
<tr class="memdesc:a5d526e1e8a7ea73e0e0859b9e383dc25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extension of the data file name for the logger.  <a href="#a5d526e1e8a7ea73e0e0859b9e383dc25">More...</a><br/></td></tr>
<tr class="separator:a5d526e1e8a7ea73e0e0859b9e383dc25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Headers for a task which saves data to an SD card. </p>
<p>This file contains the headers for a task that saves data using the SD card on a PolyDAQ board. Commands and data are sent to this task by other tasks, and this task handles the saving of data as fast as the SD card can write it.</p>
<p>Revisions: </p>
<ul>
<li>??-??-2013 GDS Original file from the ChibiOS collection of stuff </li>
<li>06-14-2014 JRR Data acquisition task (thread) split off from <code>main.c</code> </li>
<li>07-02-2014 JRR User interface spun off from the other tasks </li>
<li>07-25-2014 JRR PC interface cloned from the user interface and modified </li>
<li>10-15-2014 JRR SD card task made from the PC interface task</li>
</ul>
<p>License: This file is copyright 2014 by JR Ridgely and released under the Lesser GNU Public License, version 2. It intended for educational use only, but its use is not limited thereto. </p>

<p>Definition in file <a class="el" href="task__sd__card_8h_source.html">task_sd_card.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a80b1adfd8bda130e0cfdbbb3f943f4e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SD_TSK_DBG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;if (p_serial) *p_serial &lt;&lt; x</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switch to turn SD card task serial debugging messages on or off. </p>
<p>We can turn serial port debugging for the SD card task on or off with this define. Defining <code>SD_TSK_DBG</code> as a serial port write makes it active; defining it as nothing blocks debugging printouts from this task. </p>

<p>Definition at line <a class="el" href="task__sd__card_8h_source.html#l00076">76</a> of file <a class="el" href="task__sd__card_8h_source.html">task_sd_card.h</a>.</p>

<p>Referenced by <a class="el" href="task__sd__card_8cpp_source.html#l00082">task_sd_card::run()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a5d526e1e8a7ea73e0e0859b9e383dc25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char DATA_F_EXT[] = &quot;csv&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extension of the data file name for the logger. </p>
<p>This is the extension of the data file name, which is the part after the period. The data file name must be at most 8 characters long and the extension at most 3 characters long in the ancient MS-DOS(tm) style. Recommended extensions are CSV, for Comma Separated Variable which is a format easily read by spreadsheet formats, or TXT, which just means that the data is stored in a text format. </p>

<p>Definition at line <a class="el" href="task__sd__card_8h_source.html#l00069">69</a> of file <a class="el" href="task__sd__card_8h_source.html">task_sd_card.h</a>.</p>

<p>Referenced by <a class="el" href="task__sd__card_8cpp_source.html#l00082">task_sd_card::run()</a>.</p>

</div>
</div>
<a class="anchor" id="ab0a2d7dc24248a592b423dbc7efde902"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char DATA_F_NAME[] = &quot;data_&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Base name of the data file for the logger; a number is added after this name. </p>
<p>This is the base of the file name used for automatically generated data files. It should be the first five characters of an eight-character name, with the last three characters being an automatically generated number. </p>

<p>Definition at line <a class="el" href="task__sd__card_8h_source.html#l00059">59</a> of file <a class="el" href="task__sd__card_8h_source.html">task_sd_card.h</a>.</p>

<p>Referenced by <a class="el" href="task__sd__card_8cpp_source.html#l00082">task_sd_card::run()</a>.</p>

</div>
</div>
<a class="anchor" id="a583233f3de4cfe2f47c306fcc1621158"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint16_t SD_TICKS_PER_SYNC = 1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Time in milliseconds between forced buffer writes to the SD card. </p>
<p>This value controls how often a write to the SD card is forced by a call to the card's <code>send_now</code> modifier. Forcing the buffer to be written is helpful in that it ensures data will be written to the disk when the card is removed or power is turned off; however, forcing writes too often can slow the system down, which may cause trouble when data is being taken at a high rate. A typical value might be 1000 ms, forcing the buffer to be written to the SD card once per second. </p>

<p>Definition at line <a class="el" href="task__sd__card_8h_source.html#l00051">51</a> of file <a class="el" href="task__sd__card_8h_source.html">task_sd_card.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Apr 11 2015 12:43:10 for PolyDAQ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
